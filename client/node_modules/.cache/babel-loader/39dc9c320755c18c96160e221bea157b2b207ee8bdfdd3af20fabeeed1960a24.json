{"ast":null,"code":"import _slicedToArray from\"/Users/danielyun/Desktop/s/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from'react';import{useNavigate}from\"react-router-dom\";import keys from'../keys';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";function Sell(props){var symbol=props.symbol;var shares=props.shares;var total_purchased_price=Number(props.before).toFixed(2);var _useState=useState(\"...\"),_useState2=_slicedToArray(_useState,2),price=_useState2[0],setPrice=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),msg=_useState4[0],setMsg=_useState4[1];var navigate=useNavigate();//get current_price\nuseEffect(function(){fetch(\"\".concat(keys.url_encrypt.key,\"/api/current_price/\").concat(symbol)).then(function(response){return response.json();}).then(function(data){setPrice(data.current_price);}).catch(function(err){return console.log(err);});},[]);var total_current_price=isNaN(price)?\"...\":Number(price*shares).toFixed(2);var diff=1.0*(total_current_price-total_purchased_price)/total_purchased_price;//to do decimal division and no integer rounding\nvar percent_change=isNaN(price)?\"...\":Number(diff*100).toFixed(2);var color=percent_change>0?\"positive_arrow\":\"negative_arrow\";var arrow=percent_change>0?\"↑\":\"↓\";//handle sell\nfunction sell(e){e.preventDefault();var shares_to_sell=document.getElementById(symbol).value;console.log(\"shares to sell: \"+shares_to_sell);console.log(\"shares owned: \"+shares);if(shares_to_sell<=0)setMsg(\"Please enter a valid number of shares\");else if(shares_to_sell>shares)setMsg(\"That's more than what you own!\");else{fetch(\"\".concat(keys.url_encrypt.key,\"/auth/action\"),{method:\"POST\",body:JSON.stringify({action:\"sell\",symbol:symbol,price:price,shares_to_sell:shares_to_sell,shares_owned:shares}),headers:{'Content-Type':'application/json'}}).then(function(response){return response.json();}).then(function(data){setMsg(data.message);if(data.message===\"success\"){navigate(\"/profile\");window.location.reload(true);}}).catch(function(err){return console.log(err);});}}return/*#__PURE__*/_jsxs(\"div\",{className:\"stock_display\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"$\",total_purchased_price,\" \",\"   --->   \",\" \",/*#__PURE__*/_jsxs(\"p\",{className:color,children:[\"$\",total_current_price,\" \",arrow,\"(\",percent_change,\"%)\"]})]}),\"\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\",/*#__PURE__*/_jsxs(\"form\",{onSubmit:function onSubmit(e){return sell(e);},className:\"sell_form\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsx(\"input\",{min:\"1\",type:\"number\",className:\"form-control\",id:symbol,placeholder:\"# shares\"})}),msg!=\"\"&&msg!=\"success\"?/*#__PURE__*/_jsxs(\"div\",{className:\"error_msg\",children:[\"*\",msg,\"*\"]}):null,/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary\",children:\"Sell\"})})]})]});}export default Sell;","map":{"version":3,"names":["useState","useEffect","useNavigate","keys","jsxs","_jsxs","jsx","_jsx","Sell","props","symbol","shares","total_purchased_price","Number","before","toFixed","_useState","_useState2","_slicedToArray","price","setPrice","_useState3","_useState4","msg","setMsg","navigate","fetch","concat","url_encrypt","key","then","response","json","data","current_price","catch","err","console","log","total_current_price","isNaN","diff","percent_change","color","arrow","sell","e","preventDefault","shares_to_sell","document","getElementById","value","method","body","JSON","stringify","action","shares_owned","headers","message","window","location","reload","className","children","onSubmit","min","type","id","placeholder"],"sources":["/Users/danielyun/Desktop/s/client/src/components/Sell.js"],"sourcesContent":["import {useState, useEffect} from 'react';\nimport { useNavigate } from \"react-router-dom\";\nimport keys from '../keys';\n\nfunction Sell(props) {\n\n    const symbol = props.symbol;\n    const shares = props.shares;\n    const total_purchased_price = Number(props.before).toFixed(2);\n    const [price, setPrice]  = useState(\"...\");\n    const [msg, setMsg] = useState(\"\");\n    const navigate = useNavigate();\n\n    //get current_price\n    useEffect(() => {\n        fetch(`${keys.url_encrypt.key}/api/current_price/${symbol}`)\n        .then(response => response.json())\n        .then(data => {\n            setPrice(data.current_price);\n        })\n        .catch(err => console.log(err));\n    }, [])\n\n    const total_current_price = isNaN(price) ? \"...\" : Number(price*shares).toFixed(2);\n    const diff = (1.0 * (total_current_price -  total_purchased_price)) / total_purchased_price;     //to do decimal division and no integer rounding\n    const percent_change = isNaN(price) ? \"...\" : Number(diff * 100).toFixed(2);\n    const color = percent_change > 0 ? \"positive_arrow\" : \"negative_arrow\";\n    const arrow = percent_change > 0 ? \"↑\" : \"↓\";\n\n    //handle sell\n    function sell(e) {\n        e.preventDefault();\n        const shares_to_sell = document.getElementById(symbol).value;\n\n        console.log(\"shares to sell: \" + shares_to_sell)\n        console.log(\"shares owned: \" + shares)\n\n        if(shares_to_sell <= 0)\n            setMsg(\"Please enter a valid number of shares\");\n        else if(shares_to_sell > shares)\n            setMsg(\"That's more than what you own!\");\n        else\n        {\n            fetch(`${keys.url_encrypt.key}/auth/action`, {\n                method: \"POST\",\n                body: JSON.stringify({\n                    action: \"sell\",\n                    symbol: symbol,\n                    price: price,\n                    shares_to_sell: shares_to_sell,\n                    shares_owned: shares\n                }),\n                headers: {\n                    'Content-Type': 'application/json'\n                }\n            })\n            .then(response => response.json())\n            .then(data => {\n                setMsg(data.message);\n    \n                if(data.message === \"success\")\n                {\n                    navigate(\"/profile\");\n                    window.location.reload(true);      \n                }\n            })\n            .catch(err => console.log(err));\n        }\n    }\n\n    return (\n        <div className=\"stock_display\">\n            <div>\n                ${total_purchased_price} {\"   --->   \"} <p className={color}>${total_current_price} {arrow}({percent_change}%)</p>\n            </div>\n\n            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n\n            <form onSubmit={(e) => sell(e)} className=\"sell_form\">\n                <div className=\"form-group\">\n                    <input min=\"1\" type=\"number\" className=\"form-control\" id={symbol} placeholder=\"# shares\"></input>\n                </div>\n\n                {\n                    msg != \"\" && msg != \"success\"? \n                        <div className=\"error_msg\">\n                            *{msg}*\n                        </div>\n                    : null\n                }\n                <div>\n                    <button type=\"submit\" className='btn btn-primary'>Sell</button>\n                </div>\n            </form>\n        </div>\n    )\n}\n\nexport default Sell;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}